<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<strong>Using Pattern Matching<br>with <code>switch</code></strong>","children":[{"content":"To use pattern matching with a <code>switch</code>, first start with an<br>\nobject reference variable. Any object reference type is<br>\npermitted, provided the <code>switch</code> makes use of pattern<br>\nmatching. Next, in each case clause, define a type and<br>\npattern matching variable.","children":[{"content":"\n<pre data-lines=\"12,22\"><code class=\"language-java\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">printDetails</span><span class=\"hljs-params\">(Number height)</span> {\n  <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">message</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">switch</span> (height) {\n    <span class=\"hljs-keyword\">case</span> Integer i -&gt; <span class=\"hljs-string\">&quot;Rounded: &quot;</span> + i;\n    <span class=\"hljs-keyword\">case</span> Double d -&gt; <span class=\"hljs-string\">&quot;Precise: &quot;</span> + d;\n    <span class=\"hljs-keyword\">case</span> Number n-&gt; <span class=\"hljs-string\">&quot;Unknown: &quot;</span> + n;\n  }; <span class=\"hljs-comment\">// watch semicolon at the end</span>\n  System.out.print(message);\n}\n</code></pre>","children":[{"content":"In this example, we output different values depending on<br>\nthe type of the <code>switch</code> variable. The same rules about local<br>\nvariables and flow scoping that we learned about earlier<br>\nwith pattern matching apply. For instance, <em>the pattern<br>\nmatching variable exists only within the <code>case</code> branch for<br>\nwhich it is defined. This allows us to reuse the same<br>\nname for two <code>case</code> branches.</em>","children":[{"content":"\n<p data-lines=\"29,32\"><a href=\"https://1drv.ms/i/c/c83cfca51d5c2032/Ed24JgQv7nxJma5-xkoO7wkBKydnKGPuWYs-7SjEJ1RxAw?e=y5pZZd\">Figure 3.7</a> shows the structure of pattern matching with a<br>\n<code>switch</code> expression. <strong>It can also be used with a <code>switch</code><br>\nstatement that does not return a value.</strong></p>","children":[{"content":"From Figure 3.7, you might have noticed it includes a guard clause,<br>\nwhich is an optional conditional clause that can be added to a <code>case</code><br>\nbranch. This is similar to what we saw in  pattern matching if statement.<br>\nThe only difference is that with <code>switch</code>, the <code>when</code> keyword is required<br>\nbetween the variable and the expression. The <code>when</code> statement comes<br>\nbefore the general type.","children":[],"payload":{"tag":"li","lines":"33,39"}}],"payload":{"tag":"li","lines":"29,39"}},{"content":"\n<p data-lines=\"39,41\">Remembre: <strong>Type matches <code>switch</code> variable reference<br>\ntype so <code>default</code> clause is not needed.</strong></p>","children":[],"payload":{"tag":"li","lines":"39,41"}}],"payload":{"tag":"li","lines":"22,41"}}],"payload":{"tag":"li","lines":"12,41"}}],"payload":{"tag":"li","lines":"7,41"}},{"content":"Example:<pre data-lines=\"42,53\"><code class=\"language-java\">String <span class=\"hljs-title function_\">getTrainer</span><span class=\"hljs-params\">(Number height)</span> {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">switch</span> (height) {\n    <span class=\"hljs-keyword\">case</span> Integer i <span class=\"hljs-keyword\">when</span> i &gt; <span class=\"hljs-number\">10</span> -&gt;<span class=\"hljs-string\">&quot;Joseph&quot;</span>;\n    <span class=\"hljs-keyword\">case</span> Integer i -&gt; <span class=\"hljs-string\">&quot;Daniel&quot;</span>;\n    <span class=\"hljs-keyword\">case</span> Double num <span class=\"hljs-keyword\">when</span> num &lt;= <span class=\"hljs-number\">15.5</span> -&gt;<span class=\"hljs-string\">&quot;Peter&quot;</span>;\n    <span class=\"hljs-keyword\">case</span> Double num -&gt; <span class=\"hljs-string\">&quot;Kelly&quot;</span>;\n    <span class=\"hljs-keyword\">case</span> Number num -&gt; <span class=\"hljs-string\">&quot;Ralph&quot;</span>;\n  };\n}\n</code></pre>","children":[{"content":"Note that what is in the <code>when</code> statement always comes first.<br>\n<code>Joseph</code> works with the animal if the <code>height</code> is an <code>Integer</code><br>\ngreater than <code>10</code>. <code>Daniel</code> is then selected for all other <code>Integer</code><br>\nvalues. Likewise, <code>Peter</code> handles all <code>Double</code> measurements less<br>\nthan or equal to <code>15.5</code>, while <code>Kelly</code> handles the remaining<br>\n<code>Double</code> values. Finally, <code>Ralph</code> handles all animals that don&#x2019;t<br>\nmeet one of the previous requirements, such as if <code>Short</code> or<br>\n<code>Long</code> was used.","children":[{"content":"One advantage of guards is that now <code>switch</code> can do<br>\nsomething it&#x2019;s never done before: it can handle ranges.<br>\nPreviously, if you wanted to support a range of values<br>\nwith a <code>switch</code>, you had to list all the possible <code>case</code><br>\nvalues. With the <code>when</code> clause, you can support range<br>\nmatches.","children":[{"content":"<strong>Applying Acceptable Types</strong><br>\nOne of the simplest rules when working with <code>switch</code> and<br>\npattern matching is that the type must be the same type<br>\nas the <code>switch</code> variable or a subtype.","children":[],"payload":{"tag":"li","lines":"67,71"}},{"content":"\n<pre data-lines=\"71,79\"><code class=\"language-java\"><span class=\"hljs-type\">Number</span> <span class=\"hljs-variable\">fish</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">10</span>;\n<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">name</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">switch</span> (fish) {\n  <span class=\"hljs-keyword\">case</span> Integer freshWater -&gt; <span class=\"hljs-string\">&quot;Bass&quot;</span>;\n  <span class=\"hljs-keyword\">case</span> Number saltWater -&gt; <span class=\"hljs-string\">&quot;ClownFish&quot;</span>;\n  <span class=\"hljs-keyword\">case</span> String s -&gt; <span class=\"hljs-string\">&quot;Shark&quot;</span>; <span class=\"hljs-comment\">// DOES NOT COMPILE</span>\n};\n</code></pre>","children":[{"content":"The compiler is smart enough to know a <code>Number</code> can&#x2019;t be<br>\ncast as a <code>String</code>, resulting in this code not compiling.","children":[],"payload":{"tag":"li","lines":"79,81"}}],"payload":{"tag":"li","lines":"71,81"}}],"payload":{"tag":"li","lines":"61,81"}}],"payload":{"tag":"li","lines":"53,81"}}],"payload":{"tag":"li","lines":"41,81"}},{"content":"<strong>Ordering switch Branches</strong><br>\nThe order of <code>case</code> and <code>default</code> clauses for <code>switch</code> statement matters,<br>\nbecause more than one branch might be reached  during execution.<br>\nFor <code>switch</code> expressions that don&#x2019;t use pattern matching, ordering<br>\nisn&#x2019;t important, as only one branch can be reached.","children":[{"content":"When working with pattern matching, the order<br>\nmatters regardless of the type of <code>switch</code>!","children":[{"content":"\n<pre data-lines=\"88,98\"><code class=\"language-java\"><span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">printDetails</span><span class=\"hljs-params\">(Number height)</span> {\n  <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">message</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">switch</span> (height) {\n      <span class=\"hljs-keyword\">case</span> Number n -&gt; <span class=\"hljs-string\">&quot;Unknown: &quot;</span> + n;\n      <span class=\"hljs-keyword\">case</span> Integer i -&gt; <span class=\"hljs-string\">&quot;Rounded: &quot;</span> + i;\n      <span class=\"hljs-keyword\">case</span> Double d -&gt; <span class=\"hljs-string\">&quot;Precise: &quot;</span> + d;\n    };\n    System.out.print(message);\n}\n</code></pre>","children":[{"content":"It is impossible for a process to reach the second and third <code>case</code><br>\nclauses. This is also referred to as unreachable code (when the<br>\ncompiler detects it, a compilation error occurs).","children":[{"content":"Ordering branches is also important if a <code>when</code> clause is used.","children":[],"payload":{"tag":"li","lines":"101,102"}},{"content":"\n<pre data-lines=\"102,111\"><code class=\"language-java\">String <span class=\"hljs-title function_\">getTrainer</span><span class=\"hljs-params\">(Number animal)</span> {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">switch</span> (animal) {\n    <span class=\"hljs-keyword\">case</span> Integer i -&gt; <span class=\"hljs-string\">&quot;Daniel&quot;</span>;\n    <span class=\"hljs-keyword\">case</span> Integer i <span class=\"hljs-keyword\">when</span> i &gt; <span class=\"hljs-number\">10</span> -&gt; <span class=\"hljs-string\">&quot;Joseph&quot;</span>; <span class=\"hljs-comment\">// DOES NOT COMPILE</span>\n    &#x2026;\n   };\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"102,111"}},{"content":"It goes from the most specific to the most general, similar to multiple catch blocks.","children":[],"payload":{"tag":"li","lines":"111,112"}}],"payload":{"tag":"li","lines":"98,112"}},{"content":"The last two <code>case</code> statements are unreachable. Go from<br>\nthe most specific type to the most general.","children":[],"payload":{"tag":"li","lines":"112,114"}}],"payload":{"tag":"li","lines":"88,114"}}],"payload":{"tag":"li","lines":"86,114"}}],"payload":{"tag":"li","lines":"81,114"}},{"content":"<strong>Exhaustive <code>switch</code> Statements</strong><br>\nUp until now, only <code>switch</code> expressions were required to be<br>\nexhaustive. When using pattern matching, <code>switch</code> statements<br>\nmust be exhaustive too. As before, you can address this with<br>\na <code>default</code> clause, as this will handle all values that don&#x2019;t match<br>\na <code>case</code> clause. There is another option, though, that applies<br>\nonly when working with pattern matching.","children":[{"content":"You may have noticed that <strong>we didn&#x2019;t use any <code>default</code> clauses in<br>\nany of our previous pattern matching examples. That&#x2019;s because<br>\nwe defined our last <code>case</code> clause with a pattern matching variable<br>\ntype that is the same as the switch variable reference type.</strong>","children":[{"content":"For example, <strong>if the variable reference type of the switch expression<br>\nis type <code>Integer</code> or <code>String</code>, then you just need to make sure the last<br>\n<code>case</code> clause is of type <code>Integer</code> or <code>String</code></strong>, respectively.","children":[{"content":"\n<pre data-lines=\"128,134\"><code class=\"language-java\"><span class=\"hljs-type\">Number</span> <span class=\"hljs-variable\">zooPatrons</span> <span class=\"hljs-operator\">=</span> Integer.valueOf(<span class=\"hljs-number\">1_000</span>);\n<span class=\"hljs-keyword\">switch</span> (zooPatrons) {\n  <span class=\"hljs-keyword\">case</span> Integer count-&gt; System.out.print(count);\n}\n</code></pre>","children":[{"content":"It doesn&#x2019;t compile! Despite the <code>zooPatrons</code> object actually being of<br>\ntype <code>Integer</code>, the <code>switch</code> reference variable is of type <code>Number</code>.","children":[],"payload":{"tag":"li","lines":"134,136"}}],"payload":{"tag":"li","lines":"128,136"}}],"payload":{"tag":"li","lines":"125,136"}}],"payload":{"tag":"li","lines":"121,136"}}],"payload":{"tag":"li","lines":"114,136"}},{"content":"There are a few ways that we can fix the last example. First, we<br>\ncan change the reference type of <code>zooPatrons</code> to be <code>Integer</code>","children":[{"content":"\n<pre data-lines=\"138,144\"><code class=\"language-java\"><span class=\"hljs-type\">Integer</span> <span class=\"hljs-variable\">zooPatrons</span> <span class=\"hljs-operator\">=</span> Integer.valueOf(<span class=\"hljs-number\">1_000</span>);\n<span class=\"hljs-keyword\">switch</span> (zooPatrons) {\n  <span class=\"hljs-keyword\">case</span> Integer count-&gt; System.out.print(count);\n}\n</code></pre>","children":[{"content":"We can also add a <code>case</code> clause at the end for <code>Number</code>.","children":[{"content":"\n<pre data-lines=\"145,152\"><code class=\"language-java\"><span class=\"hljs-type\">Number</span> <span class=\"hljs-variable\">zooPatrons</span> <span class=\"hljs-operator\">=</span> Integer.valueOf(<span class=\"hljs-number\">1_000</span>);\n<span class=\"hljs-keyword\">switch</span> (zooPatrons) {\n  <span class=\"hljs-keyword\">case</span> Integer count -&gt; System.out.print(count);\n  <span class=\"hljs-keyword\">case</span> Number count -&gt; System.out.print(<span class=\"hljs-string\">&quot;Number&quot;</span>);\n}\n</code></pre>","children":[{"content":"We can always add a <code>default</code> clause to a <code>switch</code> that covers<br>\neverything.  What if you combine different solutions?","children":[{"content":"\n<pre data-lines=\"154,162\"><code class=\"language-java\"><span class=\"hljs-type\">Number</span> <span class=\"hljs-variable\">zooPatrons</span> <span class=\"hljs-operator\">=</span> Integer.valueOf(<span class=\"hljs-number\">1_000</span>);\n<span class=\"hljs-keyword\">switch</span> (zooPatrons) {\n  <span class=\"hljs-keyword\">case</span> Integer count -&gt; System.out.print(count);\n  <span class=\"hljs-keyword\">case</span> Number count -&gt; System.out.print(<span class=\"hljs-string\">&quot;Number&quot;</span>);\n  <span class=\"hljs-keyword\">default</span> -&gt; System.out.print(<span class=\"hljs-string\">&quot;Default&quot;</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"li","lines":"154,162"}},{"content":"The code does not compile, regardless of how you order the branches.<br>\nThe compiler is smart enough to realize the last two statements are<br>\nredundant","children":[],"payload":{"tag":"li","lines":"162,165"}}],"payload":{"tag":"li","lines":"152,165"}}],"payload":{"tag":"li","lines":"145,165"}}],"payload":{"tag":"li","lines":"144,165"}}],"payload":{"tag":"li","lines":"138,165"}}],"payload":{"tag":"li","lines":"136,165"}}],"payload":{"tag":"h1","lines":"6,7"}},{"initialExpandLevel":1})</script>
</body>
</html>
